<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>axiosçš„å¸¸è§ä½¿ç”¨æ–¹å¼</title>
    <style>
        li {
            list-style: none;
            width: 100%;
        }
        .content-box {
            width: 300px;
            /* height: 300px; */
            background-color: skyblue;
        }
    </style>
</head>
<body>
    <h1>axios çš„å¸¸è§è¯·æ±‚ä½¿ç”¨æ–¹å¼</h1>
    <div class="content-box">
        formData: ä¸Šä¼ webè¡¨å•æ–‡ä»¶ æ¯”å¦‚å›¾ç‰‡æˆ–è€…é™„ä»¶
        application/json: ä¸Šä¼ jsonå¯¹è±¡
    </div>
    <ul>
        <li>
            <h3>1.GET è·å–æ•°æ® ç”¨åœ¨æŸ¥è¯¢åˆ—è¡¨çš„æ—¶å€™ç”¨åˆ°</h3>
            <h2>get æ–¹æ³•çš„é…ç½® axios.get(url[,config])</h2>
            <div class="content-box">
                get æ–¹å¼è¯·æ±‚ä½¿ç”¨ params å‚æ•°ä¼ é€’ params å¿…é¡»æ˜¯ä¸€ä¸ªæ— æ ¼å¼å¯¹è±¡ï¼ˆplain objectï¼‰æˆ–
                URLSearchParams å¯¹è±¡ paramsa å¿…é¡»æ˜¯é”®å€¼å¯¹æ–¹å¼ä¼ é€’ å¦åˆ™ axios ä¼šè‡ªåŠ¨å¸®ä½ å¤„ç†ä¸º 0=å‚æ•°çš„å½¢å¼
                å‚æ•°ï¼šurlåæ‹¼æ¥å‚æ•° è¯·æ±‚ä½“ï¼ˆrequest bodyï¼‰ä¼ å‚ï¼ˆparams:......ï¼‰
            </div>
        </li>
        <li>
            <h3>2.POST æäº¤æ•°æ® è¡¨å•æäº¤ã€æ–‡ä»¶ä¸Šä¼ </h3>
            <h2>post æ–¹æ³•çš„é…ç½® axios.post(url[,data[,config]])</h2>
            <div class="content-box">
                å‚æ•°ï¼šurlæ‹¼æ¥å’Œè¯·æ±‚ä½“ä¼ å‚ï¼ˆdata:......ï¼‰
                è¯·æ±‚æ–¹å¼ï¼šformDataå’Œapplication/json
            </div>
        </li>
        <li>
            <h3>3.PUT æ›´æ–°æ•°æ® æ‰€æœ‰æ•°æ®æ¨é€åˆ°åç«¯</h3>
            <h2>put æ–¹æ³•çš„é…ç½® axios.put(url[,data[,config]])</h2>
            <div class="content-box">
                å‚æ•°ï¼šurlæ‹¼æ¥å’Œè¯·æ±‚ä½“ä¼ å‚ï¼ˆdata:......ï¼‰
                è¯·æ±‚æ–¹å¼ï¼šformDataå’Œapplication/json
            </div>
        </li>
        <li>
            <h3>4.DELETE åˆ é™¤æ•°æ® æ ¹æ®IDåˆ é™¤æŸåˆ—æ•°æ®</h3>
            <h2>delete æ–¹æ³•çš„é…ç½® axios.delete(url[,config])</h2>
            <div class="content-box">
                å‚æ•°ï¼šurlæ‹¼æ¥å’Œè¯·æ±‚ä½“ä¼ å‚ï¼ˆdata:......ï¼‰
                è¯·æ±‚æ–¹å¼ï¼šformDataå’Œapplication/json
            </div>
        </li>
        <li>
            <h3>5.ä¸ºæ–¹ä¾¿èµ·è§ ä¸ºæ‰€æœ‰æ”¯æŒçš„è¯·æ±‚æ–¹æ³•æä¾›äº†åˆ«å</h3>
            <h2>delete æ–¹æ³•çš„é…ç½® axios.delete(url[,config])</h2>
            <div class="content-box">
                å‚æ•°ï¼šurlæ‹¼æ¥å’Œè¯·æ±‚ä½“ä¼ å‚ï¼ˆdata:......ï¼‰
            </div>
        </li>
    </ul>
    <div class="content-box">
        æ€»ç»“ï¼š
        <p>1.getã€deleteè¯·æ±‚æ–¹å¼ä¸­ ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¯·æ±‚url ç¬¬äºŒä¸ªå‚æ•°ä¸ºè¯·æ±‚çš„ä¸€äº›é…ç½®é¡¹ éœ€è¦ä¼ é€’ç»™åç«¯çš„å‚æ•°åŒ…å«åœ¨é…ç½®é¡¹çš„ data æˆ–è€… params å±æ€§ä¸­</p>
        <p>2.postã€putè¯·æ±‚æ–¹å¼ä¸­ ç¬¬ä¸€ä¸ªå‚æ•°ä¹Ÿæ˜¯è¯·æ±‚url ç¬¬äºŒä¸ªå‚æ•°ä¸ºå…¥å‚çš„jsonæ•°æ® ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å…¥å‚ä»¥å¤–çš„å…¶å®ƒé…ç½®é¡¹</p>
        <p>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.jianshu.com/p/53deecb09077">Axios å„ç§è¯·æ±‚æ–¹å¼ä¼ é€’å‚æ•°æ ¼å¼</a></p>
        <p>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.jianshu.com/p/37f91b532a21">axios POSTä¸‰ç§è¯·æ±‚æ–¹å¼</a></p>
    </div>

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
        // console.log('ğŸŒˆğŸŒˆğŸŒˆğŸŒˆğŸŒˆğŸŒˆ',axios);

        // 1-1. get ç®€å†™æ¨¡å¼ä¼ å‚
        axios.get('/user?ID=12345&name=å¼ ä¸‰&age=25')
            // ? åé¢æ‹¼æ¥çš„æ˜¯å‚æ•°
            .then(res => {
                // æˆåŠŸä¹‹åçš„å›è°ƒå‡½æ•°
                console.log(res);
            }).catch(err => {
                // å¤±è´¥ä¹‹åçš„å›è°ƒå‡½æ•°
                console.log(err);
            })

        // 1-2. get ä¼ å‚
        axios.get('/user', {
                params: {
                    ID: 12345,
                    name: 'å¼ ä¸‰',
                    age: 25
                }
            })
            .then(res => {
                console.log(res);
            })
            .catch(err => {
                console.log(err);
            })

        // 1-3. async await æ¨¡å¼ä¼ å‚
        async function getUser() {
            try {
                const res = await axios.get('/user?ID=12345&name=zhangsan&age=25')
                console.log(res);
            } catch (e) {
                console.log(e);
            }
        }


        // 2-1. post ç®€å†™æ¨¡å¼ä¼ å‚
        axios.post('/user', {
                firstName: 'å¸…',
                lastName: 'å¤§çŒª'
            })
            .then(res => {
                console.log(res);
            })
            .catch(err => {
                console.log(err);
            })

        // 4-1. ä¼ å‚æ ¼å¼
        // å¦‚æœæœåŠ¡ç«¯å°†å‚æ•°ä½œä¸ºjavaå¯¹è±¡æ¥æ¥æ”¶
        axios.delete('demo/url', {
            data: {
                id: 123,
                name: 'å¤§çŒª',
            }
        })
        // å¦‚æœæœåŠ¡ç«¯å°†å‚æ•°ä½œä¸ºurlå‚æ•°æ¥æ¥æ”¶ åˆ™è¯·æ±‚çš„urlä¸ºï¼šwww.demo/url?id=123&name=å¤§çŒªè¿™ç§æ ¼å¼
        axios.delete('demo/url', {
            params: {
                id: 123,
                name: 'å¤§çŒª',
            }
        })

    </script>

    <script>
        // let $error = utils.debounce(Message.error, 2000, true);//2ç§’å†… åªåˆæ¬¡ç”Ÿæ•ˆ

        const phone = Cookies.get('phone')
        const userName = Cookies.get('userName')
        const loginName = Cookies.get('loginName')
        const Authorization = Cookies.get('Authorization')
        // æŠŠä¸Šé¢ä»cookieé‡Œé¢è·å–åˆ°çš„ä¿¡æ¯åˆå¹¶åˆ°APP_USERè¿™ä¸ªå¯¹è±¡ä¸­
        const APP_USER = {
            phone,
            userName,
            loginName,
            newtoken: Authorization,
        }
        // æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨ request
        axios.interceptors.request.use(request => {
            // åœ¨å‘é€è¯·æ±‚ä¹‹å‰åšäº›ä»€ä¹ˆ æ¯”å¦‚åœ¨æ¯ä¸ªè¯·æ±‚å‘é€ä¹‹å‰ åœ¨è¯·æ±‚å¤´æ·»åŠ ç™»å½•è®¤è¯ä¿¡æ¯(å› ä¸ºæ¥å£éœ€è¦token)
            request.headers['APP_USER'] = JSON.stringify(APP_USER)
            return request
        })
        // æ·»åŠ å“åº”æ‹¦æˆªå™¨ response
        axios.interceptors.response.use(response => {
            // å¯¹å“åº”æ•°æ®åšç‚¹ä»€ä¹ˆ æ¯”å¦‚
            return new Promise((resolve,reject) => {

            })
        }, error => {
            // å¯¹å“åº”é”™è¯¯åšç‚¹ä»€ä¹ˆ æ¯”å¦‚æ˜¾ç¤ºå‡ºé”™ä¿¡æ¯ç­‰
            const { response, message } = error
            let errorMsg = ''
            // åˆ†ä¸ºæœ‰å“åº”å’Œæ— å“åº”ä¸¤ç§æƒ…å†µ
            if (!response) {
                errorMsg = 'ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æµ‹ç½‘ç»œæ˜¯å¦æ­£å¸¸ï¼'
            } else {
                const { data } = response
                errorMsg = data && data.errorMsg ? data.errorMsg : 'æœåŠ¡å™¨å‘ç”Ÿå¼‚å¸¸ï¼Œè¯·è”ç³»ç®¡ç†å‘˜'
            }
            $error(errorMsg)
            // åœ¨æ§åˆ¶å°æ‰“å°å‡ºé”™çš„æ—¥å¿—ä¿¡æ¯
            console.log(`%c ${ message || errorMsg }`, 'color:#fff,background-color:red');
            return Promise.reject(error)
        })
    </script>
</body>
</html>